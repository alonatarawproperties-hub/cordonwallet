REPLIT AGENT PROMPT (do exactly this, keep changes minimal, don’t refactor unrelated parts)

GOAL:
Temporarily DISABLE ALL Jupiter “platform fee / referral fee” injection end-to-end (quote + swap), because USDC→SOL keeps failing with Jupiter Route custom error 0x1788 (InvalidAccountData). Keep the existing “SOL success fee after swap confirms” system untouched.

IMPORTANT CONTEXT:
Jupiter Metis Swap docs show:
- platformFeeBps is a QUOTE query param; if it’s passed, /swap must also receive feeAccount.  [oai_citation:0‡dev.jup.ag](https://dev.jup.ag/api-reference/swap/quote)
So we must ensure platformFeeBps is NEVER sent in quote AND feeAccount is NEVER sent in swap, and the quote object we forward to /swap must not contain platformFee.

WHAT TO CHANGE (ONLY THESE FILES):
1) server/swap/jupiter.ts
2) server/swap/route.ts (only if it sets platformFeeBps anywhere)
3) server/swap/index.ts or server/routes.ts (where the /api/swap/solana/quote and /api/swap/solana/swap proxy handlers live)
4) client/services/jupiter.ts (or wherever client calls quote/swap endpoints)

STEP-BY-STEP TASKS:

A) Add a hard “no platform fee” kill-switch (default ON)
- In server/swap/jupiter.ts create:
  const FORCE_DISABLE_JUPITER_PLATFORM_FEES = true;
- Create helper:
  function platformFeesAllowed(): boolean { return !FORCE_DISABLE_JUPITER_PLATFORM_FEES && process.env.CORDON_PLATFORM_FEE_ENABLED === "true"; }

B) Quote: NEVER send platformFeeBps if platform fees are disabled
- In getQuote() (server/swap/jupiter.ts), make sure the request to:
  GET /swap/v1/quote
  does NOT include platformFeeBps unless platformFeesAllowed() is true.
- Also: after receiving quoteResponse, if platform fees are disabled, explicitly delete/strip it:
  if (!platformFeesAllowed()) {
    (quoteResponse as any).platformFee = null;
  }
- Add log:
  console.log("[SwapFee] platformFeesAllowed:", platformFeesAllowed(), "quote.platformFee:", quoteResponse?.platformFee ?? null);

C) Swap build: NEVER send feeAccount/platformFee* to Jupiter, and NEVER forward quote with platformFee
- In the code that calls POST /swap/v1/swap (server-side proxy):
  - Ensure request body DOES NOT include feeAccount, platformFeeBps, platformFee, referralAccount, or any “disablePlatformFee” fields (remove them).
  - BEFORE calling Jupiter swap endpoint, force:
    const sanitizedQuote = { ...quoteResponse, platformFee: null };
    (and ensure routePlan etc stays intact)
  - Use sanitizedQuote in the swap request body.
- Add log (single-line JSON) right before calling Jupiter:
  console.log("[SwapFee] swap-build sanitized:", JSON.stringify({
    platformFeesAllowed: platformFeesAllowed(),
    hasPlatformFeeOnQuote: !!(quoteResponse as any)?.platformFee,
    sanitizedPlatformFee: (sanitizedQuote as any)?.platformFee ?? null,
    hasFeeAccount: "feeAccount" in swapBody,
    endpoint: jupiterBaseUrlUsed
  }));

D) Remove/neutralize fee-account derivation code paths
- In server/swap/jupiter.ts:
  - Keep deriveFeeAccountAddress() in file if you want, but it must never be called while FORCE_DISABLE_JUPITER_PLATFORM_FEES=true.
  - If it’s referenced anywhere, guard it with:
    if (!platformFeesAllowed()) return null;
- Ensure NO other server files call deriveFeeAccountAddress when disabled.

E) Client: ensure client never requests quotes with platform fees and never sends fee params
- In client/services/jupiter.ts (or wherever):
  - Remove platformFeeBps from quote requests to your backend.
  - Remove any feeAccount/platformFee fields from swap requests to your backend.
  - If UI has “platform fee” toggle or percent display, keep UI but it should be OFF/hidden by default; do NOT send anything.

F) Retry safety (don’t break working SOL→USDC)
- Keep existing success-fee charging logic as-is.
- Add one special retry ONLY if you currently have retry logic:
  If Jupiter swap returns 0x1788, re-request a fresh quote from Jupiter WITHOUT platformFeeBps and rebuild swap again (still no platform fees). This makes sure no stale quote is used.
  Make the retry silent and log:
  console.warn("[SwapFee] 0x1788 detected – retrying with fresh no-fee quote");

G) Verification checklist (print these in logs)
After changes, do these tests:
1) SOL→USDC should succeed (and success-fee still charges after confirm).
2) USDC→SOL should no longer fail due to platform fees injection (if it still fails, we’ll know fees are not the cause).
3) Confirm logs show:
   platformFeesAllowed: false
   quote.platformFee: null
   swap-build sanitized hasPlatformFeeOnQuote false/true but sanitizedPlatformFee null
   hasFeeAccount false

DELIVERABLE:
- Make the code changes, restart backend, and tell me exactly which files changed + the key logs from a USDC→SOL attempt.

DO NOT:
- Don’t change any unrelated swap routing logic.
- Don’t refactor folder structure.
- Don’t change the success-fee system.
- Don’t introduce new deps unless absolutely required.